# Описание проекта


Проект «Barsik» – веб-сервис для поиска, заказа и управления услугами pet-sitter’ов: выгул, присмотр, передержка, домашние визиты и дополнительные сервисы (груминг, вакцинация и т. п.). Платформа объединяет владельцев животных и проверенных исполнителей, обеспечивает безопасное бронирование и оплату, простой обмен сообщениями.

Ключевые возможности: профили и портфолио pet-sitter’ов; фильтрация и поиск по локации, типу животного, услуге и рейтингу; мгновенное бронирование и предварительная бронь; система отзывов и рейтингов; безопасные платежи и расчеты через платформу; трекинг прогулок и отчеты; расписание и календарь; встроенный чат.

## Основные функции


- **создание и изменение профиля и портфолио**
- **поиск специалистов с применением фильтров**
- **бронирование специалистов**
- **оплата услуг**
- **система отзывов**
- **встроенный чат**


## Стек используемых технологий

- Java
- Spring Boot
- MySQL

## Роли пользователей
- Неавторизованный пользователь (Guest)
- Администратор (Admin)
- Клиент (Owner)
- Исполнитель (Sitter)

## Схема БД
[Схема БД](./sql/db_v2.svg)



## API: Endpoint Overview


### 1. Аутентификация и управление профилем


- `POST /auth/register`  
    **Описание**: Регистрация нового пользователя. В теле запроса передается `role` ('owner' или 'sitter'), на основе которого создается запись в соответствующей таблице (`owners` или `sitters`).
    
- `POST /auth/login`  
    **Описание**: Аутентификация пользователя по email и паролю. Возвращает JWT токен для последующих запросов.
    
- `GET /profile`  
    **Описание**: Получение информации о текущем аутентифицированном пользователе (из таблиц `users`, `owners`/`sitters`).
    
- `PUT /profile`  
    **Описание**: Обновление базовой информации своего профиля.

### 2. Sitters



- `GET /sitters`  
    **Описание**: Публичный поиск ситтеров с возможностью фильтрации по геолокации, типу услуг, рейтингу, цене и датам доступности.
    
- `GET /sitters/{userId}`  
    **Описание**: Получение детального публичного профиля ситтера, включая его услуги с ценами, средний рейтинг и отзывы.
    
- `PUT /sitters/me/profile`  
    **Описание**: Ситтер обновляет свой профессиональный профиль (опыт, часовая ставка и т.д.).
    
- `POST /sitters/me/services`  
    **Описание**: Ситтер добавляет или обновляет услуги, которые он предоставляет, и устанавливает на них цены.
    
- `GET /sitters/me/availability`  
    **Описание**: Ситтер получает свой календарь доступности.
    
- `POST /sitters/me/availability`  
    **Описание**: Ситтер добавляет или обновляет временные слоты, когда он доступен для работы.
  
### 3. Owners and Pets

- `GET /owners/me/pets`  
    **Описание**: Владелец получает список своих питомцев.
    
- `POST /owners/me/pets`  
    **Описание**: Владелец добавляет нового питомца в свой профиль.
    
- `GET /owners/me/pets/{petId}`  
    **Описание**: Получение информации о конкретном питомце.
    
- `PUT /owners/me/pets/{petId}`  
    **Описание**: Владелец обновляет информацию о своем питомце.
    
- `DELETE /owners/me/pets/{petId}`  
    **Описание**: Владелец удаляет питомца из своего профиля.
    

### 4. Bookings and orders


- `POST /bookings`  
    **Описание**: Владелец создает новый запрос на бронирование. В теле запроса указывается `sitter_id`, `pet_id`, `service_id`, `start_time`, `end_time`. Статус по умолчанию — `pending`.
    
- `GET /bookings`  
    **Описание**: Получение списка своих бронирований (как для владельца, так и для ситтера). Можно фильтровать по статусу (`pending`, `confirmed`, `completed` и т.д.).
    
- `GET /bookings/{bookingId}`  
    **Описание**: Получение детальной информации о конкретном бронировании.
    
- `PATCH /bookings/{bookingId}/confirm`  
    **Описание**: Ситтер подтверждает бронирование. Статус меняется на `confirmed`.
    
- `PATCH /bookings/{bookingId}/cancel`  
    **Описание**: Отмена бронирования (может быть инициирована как владельцем, так и ситтером). Статус меняется на `cancelled_by_owner` или `cancelled_by_sitter`.
    

### 5. Payments and reviews


- `POST /bookings/{bookingId}/payments`  
    **Описание**: Инициация процесса оплаты для подтвержденного бронирования. Интегрируется с платежной системой (например, Stripe).
    
- `POST /webhooks/payments`  
    **Описание**: Вебхук для получения уведомлений от платежной системы об успешной оплате или ошибке. Обновляет `payment_status` в таблице `bookings`.
    
- `POST /bookings/{bookingId}/reviews`  
    **Описание**: Владелец оставляет отзыв и выставляет рейтинг после завершения бронирования (`completed`).
    
- `GET /sitters/{userId}/reviews`  
    **Описание**: Публичный эндпоинт для просмотра всех отзывов о конкретном ситтере.
    

### 6. Взаимодействие во время заказа


- `POST /bookings/{bookingId}/tracking`  
    **Описание**: Ситтер начинает, обновляет или завершает трекинг прогулки, отправляя координаты.
    
- `GET /bookings/{bookingId}/tracking`  
    **Описание**: Владелец получает данные о маршруте прогулки в реальном времени или после ее завершения.
    
- `GET /conversations`  
    **Описание**: Получение списка всех диалогов пользователя.
    
- `GET /conversations/{userId}`  
    **Описание**: Получение истории сообщений с конкретным пользователем.
    
- `POST /conversations/{userId}/messages`  
    **Описание**: Отправка сообщения в диалог. Можно привязать к конкретному бронированию, передав `bookingId`.
    

### 7. Справочники и администрирование

- `GET /services`  
    **Описание**: Получение списка всех услуг и их категорий, доступных на платформе.
    
- `POST /admin/services`  
    **Описание**: (Только для администратора) Создание новой услуги.
    
- `PATCH /admin/sitters/{userId}/verify`  
    **Описание**: (Только для администратора) Верификация профиля ситтера.
